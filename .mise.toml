[tools]
flutter = "latest"
dart = "latest"
bun = "latest"

# ===== Daily Development =====

[tasks.setup]
description = "ğŸ§° Initialize project environment and dependencies"
run = [
    "echo 'ğŸ§° Setting up Flutter project environment...'",
    "flutter doctor -v",
    "flutter pub get",
    "dart pub run build_runner build --delete-conflicting-outputs",
    "bun install -g firebase-tools",
    "echo 'âœ… Setup complete!'",
    "echo ''",
    "echo 'ğŸ“Œ Next steps:'",
    "echo '  mise run dev     # Start development server'",
    "echo '  mise run gen     # Generate code'",
    "echo '  mise run test    # Run tests'",
]

# ===== Zen Tools Integration =====

[tasks.zen-thinkdeep]
description = "ğŸ§  Perform comprehensive deep analysis using AI-powered thinkdeep tool"
run = [
    "echo 'ğŸ§  Running comprehensive deep analysis...'",
    "bash scripts/zen-tools/cli_interface.sh thinkdeep ${args}",
    "echo 'âœ… Deep analysis complete'",
]

[tasks.zen-debug]
description = "ğŸ” Execute intelligent debugging session with AI-powered debug tool"
run = [
    "echo 'ğŸ” Running enhanced debugging session...'",
    "bash scripts/zen-tools/cli_interface.sh debug ${args}",
    "echo 'âœ… Enhanced debugging complete'",
]

[tasks.zen-help]
description = "â„¹ï¸  Display comprehensive usage information for zen tools"
run = [
    "bash scripts/zen-tools/cli_interface.sh help",
]

[tasks.dev]
description = "ğŸ“± Launch mobile development server with hot reload"
run = [
    "echo 'ğŸ“± Starting mobile development server with hot reload...'",
    "flutter run",
]

[tasks.dev-web]
description = "ğŸŒ Launch web development server with hot reload"
run = [
    "echo 'ğŸŒ Starting web development server with hot reload...'",
    "flutter run -d chrome",
]

[tasks.gen]
description = "âš™ï¸  Execute build runner code generation"
run = [
    "echo 'âš™ï¸  Generating code with build runner...'",
    "dart pub run build_runner build --delete-conflicting-outputs",
    "echo 'âœ… Code generation complete'",
]

[tasks.fix]
description = "âœ¨ Format, analyze and fix code quality issues"
run = [
    "echo 'âœ¨ Performing code quality checks and formatting...'",
    "dart format lib/ test/",
    "flutter analyze",
    "echo 'âœ… Code quality check complete'",
]

[tasks.test]
description = "ğŸ§ª Run all tests with coverage report generation"
run = [
    "echo 'ğŸ§ª Executing test suite with coverage...'",
    "flutter test --coverage",
    "echo 'ğŸ“Š Coverage report: coverage/lcov.info'",
    "echo 'ğŸ’¡ Tip: Run mise run coverage to generate HTML report'",
]

# ===== Development Support =====

[tasks.watch]
description = "ğŸ”„ Watch files continuously and auto-generate code on changes"
run = [
    "echo 'ğŸ”„ Starting continuous file watch mode...'",
    "echo 'ğŸ’¡ Code will be automatically generated when files are changed'",
    "dart pub run build_runner watch",
]

[tasks.coverage]
description = "ğŸ“ˆ Generate interactive HTML coverage report from test results"
run = [
    "echo 'ğŸ“ˆ Generating comprehensive HTML coverage report...'",
    "if [ ! -f coverage/lcov.info ]; then echo 'âš ï¸  Coverage file not found. Please run mise run test first'; exit 1; fi",
    "genhtml coverage/lcov.info -o coverage/html --ignore-errors source",
    "echo 'âœ… HTML coverage report: coverage/html/index.html'",
    "echo 'ğŸ’¡ Open coverage/html/index.html in your browser to view'",
]

# ===== Building =====

[tasks.build-android]
description = "ğŸ“± Build optimized Android APK/AAB for production"
run = [
    "echo 'ğŸ“± Building optimized Android application...'",
    "flutter pub get",
    "dart pub run build_runner build --delete-conflicting-outputs",
    "flutter build appbundle --release",
    "echo 'âœ… Android App Bundle: build/app/outputs/bundle/release/app-release.aab'",
]

[tasks.build-ios]
description = "ğŸ Build optimized iOS IPA for App Store distribution"
run = [
    "echo 'ğŸ Building optimized iOS application...'",
    "flutter pub get",
    "dart pub run build_runner build --delete-conflicting-outputs",
    "flutter build ipa --release",
    "echo 'âœ… iOS IPA: build/ios/ipa/*.ipa'",
]

[tasks.build-web]
description = "ğŸŒ Build optimized web application for deployment"
run = [
    "echo 'ğŸŒ Building optimized web application...'",
    "flutter pub get", 
    "dart pub run build_runner build --delete-conflicting-outputs",
    "flutter build web --release",
    "echo 'âœ… Web version: build/web/'",
]

# ===== Maintenance =====

[tasks.clean]
description = "ğŸ§¹ Clean project artifacts and refresh dependencies"
run = [
    "echo 'ğŸ§¹ Cleaning project artifacts and refreshing dependencies...'",
    "flutter clean",
    "flutter pub get",
    "dart pub run build_runner clean",
    "dart pub run build_runner build --delete-conflicting-outputs",
    "echo 'âœ… Cleanup complete'",
]

[tasks.upgrade]
description = "â¬†ï¸  Upgrade all dependencies to latest compatible versions"
run = [
    "echo 'â¬†ï¸  Upgrading project dependencies...'",
    "flutter pub upgrade",
    "dart pub run build_runner clean",
    "dart pub run build_runner build --delete-conflicting-outputs",
    "echo 'âœ… Dependencies updated'",
    "echo 'ğŸ’¡ Please check changes in pubspec.yaml'",
]

# ===== External Service Integration =====

[tasks.firebase]
description = "ğŸ”¥ Initialize and configure Firebase project backend services"
run = [
    "echo 'ğŸ”¥ Setting up Firebase backend services...'",
    "firebase login",
    "firebase init",
    "echo 'âœ… Firebase setup complete'",
    "echo ''",
    "echo 'ğŸ“Œ Next steps:'",
    "echo '  1. Place ios/Runner/GoogleService-Info.plist'",
    "echo '  2. Place android/app/google-services.json'",
    "echo '  3. Enable Authentication/Firestore in Firebase Console'",
]

# ===== Help =====

[tasks.help]
description = "ğŸ“‹ Display comprehensive list of all available commands"
run = [
    "echo 'ğŸ“‹ Flutter App Template - Available Commands'",
    "echo ''",
    "echo 'ğŸ“± Daily development:'",
    "echo '  setup     Initialize project environment and dependencies'", 
    "echo '  dev       Launch mobile development server with hot reload'",
    "echo '  dev-web   Launch web development server with hot reload'",
    "echo '  gen       Execute build runner code generation'",
    "echo '  fix       Format, analyze and fix code quality issues'",
    "echo '  test      Run all tests with coverage report generation'",
    "echo ''",
    "echo 'ğŸ§  Zen Tools integration:'",
    "echo '  zen-thinkdeep   Perform deep analysis with thinkdeep AI tool'",
    "echo '  zen-debug       Execute intelligent debugging with zen AI tool'",
    "echo '  zen-help        Display zen tools usage information'",
    "echo ''",
    "echo 'ğŸ”„ Development support:'",
    "echo '  watch     Watch files continuously and auto-generate code on changes'",
    "echo '  coverage  Generate interactive HTML coverage report from test results'",
    "echo ''",
    "echo 'âš™ï¸  Building:'",
    "echo '  build-android  Build optimized Android APK/AAB for production'",
    "echo '  build-ios      Build optimized iOS IPA for App Store distribution'", 
    "echo '  build-web      Build optimized web application for deployment'",
    "echo ''",
    "echo 'ğŸ§¹ Maintenance:'",
    "echo '  clean     Clean project artifacts and refresh dependencies'",
    "echo '  upgrade   Upgrade all dependencies to latest compatible versions'",
    "echo ''",
    "echo 'â˜ï¸  External integration:'",
    "echo '  firebase  Initialize and configure Firebase project backend services'",
    "echo ''",
    "echo 'ğŸ“‹ Help:'",
    "echo '  help      Display comprehensive list of all available commands'",
]
